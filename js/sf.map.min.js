(function(e){e.fn.extend({btoaSubmitSearch:function(){var e=this;e.submit(function(t){if(typeof spotsSearchAjaxObj!="undefined"){spotsSearchAjaxObj.abort()}jQuery("#slider").spin({lines:11,length:11,width:5,radius:11,corners:1,speed:2,shadow:false});jQuery(".overlay-title-wrapper").remove();jQuery(".overlay-featured-wrapper").remove();if(typeof theDirections!="undefined"){theDirections.setMap(null)}jQuery("#slider-map").removeOverlays();jQuery("#slider-map").gmap3({get:{name:"marker",all:true,tag:"spot",callback:function(e){jQuery.each(e,function(e,t){if(typeof clusterManager!="undefined"){clusterManager.removeMarker(t)}})}}});jQuery("#slider-map").gmap3({clear:{name:"marker",tag:"spot"}});if(jQuery("#main-content").length>0){if(typeof hasFormLoadedOnce!="undefined"){jQuery("#main-content")._sf_before_loading_spots()}}if(typeof _sf_load_only_spot_cats=="undefined"){_sf_load_only_spot_cats=null}if(typeof _sf_load_only_spot_tags=="undefined"){_sf_load_only_spot_tags=null}if(jQuery.urlParam("radius")!=null&&typeof hasFormLoadedOnce=="undefined"){var n=jQuery.urlParam("radius")}else{var n=null}spotsSearchAjaxObj=jQuery.ajax({url:sf.ajaxurl,type:"post",dataType:"json",data:{action:"ajaxSearchSpots",nonce:sf.search_spots_nonce,data:e.serialize(),load_tax:_sf_load_only_spot_cats,load_tag:_sf_load_only_spot_tags,force_radius:n},success:function(t){console.log(t);jQuery("#slider").spin(false);if(t.error){alert(t.error_message)}else{if(t.found>0){jQuery("#listing-results-page").show();jQuery.each(t.posts,function(e,t){if(t.latitude&&t.longitude&&jQuery("#slider-map").length>0){if(t.thumb==""){t.featured=false}jQuery("#slider-map").addNewPin(t.id,t.latitude,t.longitude,t.pin,t.title,t.permalink,t.featured,t.thumb)}});_sf_all_pins_loaded=true}else{jQuery("#listing-results-page").hide()}if(t.change_location&&jQuery("#slider-map").length>0){jQuery("#slider-map").gmap3("get").panTo(new google.maps.LatLng(t.change_location_lat,t.change_location_lng));if(!t.change_radius){jQuery("#slider-map")._sf_draw_radius(null,null,null,null,null,"destroy")}}if(t.change_radius&&jQuery("#slider-map").length>0){jQuery("#slider-map")._sf_draw_radius(t.change_radius,t.radius_lat,t.radius_lng,t.distance_type,t.radius_field_id,t.radius_field_val)}if(t.destroy_radius&&jQuery("#slider-map").length>0){jQuery("#slider-map")._sf_draw_radius(null,null,null,null,null,null,"destroy")}if(t.change_zoom&&jQuery("#slider-map").length>0){jQuery("#slider-map").gmap3("get").setZoom(parseInt(t.change_zoom))}if(t.message){jQuery("#slider-map-message span").html(t.message).parent().fadeIn(300,function(){jQuery(this).delay(5e3).fadeOut(300)});jQuery("#slider-map-message .notify-me")._sf_open_user_notification()}if(t.slider_bar_count){jQuery("#listing-results-count").html(t.slider_bar_count)}if(t.list_url){jQuery("#listing-results-page").attr("href",t.list_url)}if(typeof _sf_send_user_to_listings!="undefined"){window.location.href=t.list_url}if(jQuery("#main-content").length>0){jQuery("#_sf_post_ids").val(t.post_ids);if(t.custom_query){if(e.find("#_sf_search_is_taxonomy").length>0){var n=t.list_url.split("?");var r=window.location.href.split("?");t.list_url=r[0]+"?"+n[1]}jQuery("#main-content")._sf_after_loading_spots(t.list_url,t.post_ids,"force_ajax")}else if(typeof hasFormLoadedOnce!="undefined"){if(e.find("#_sf_search_is_taxonomy").length>0){var n=t.list_url.split("?");var r=window.location.href.split("?");t.list_url=r[0]+"?"+n[1]}jQuery("#main-content")._sf_after_loading_spots(t.list_url,t.post_ids)}else{hasFormLoadedOnce=true}}}}});t.preventDefault();return false})},addNewPin:function(e,t,n,r,i,s,o,u,a){var f=this;var l='<div class="overlay-title-wrapper" id="overlay-title-'+e+'"><a href="'+s+'"><span class="title"><span>'+i+'</span></span></a><span class="arrow-down"></span></div>';if(o=="true"){l+='<div class="overlay-featured-wrapper overlay-featured-wrapper-'+e+'"><a href="'+s+'"><img src="'+u+'" alt="'+i+'" title="'+i+'" /></a><span class="arrow-down"></span></div>'}jQuery(f).gmap3({marker:{id:e,tag:"spot",options:{position:new google.maps.LatLng(t,n),icon:{url:r}},events:{mouseover:function(e,r,i){if(jQuery("#map-overlay-"+i.id).length===0){if(o=="true"){jQuery(".overlay-featured-wrapper-"+i.id).sf_open_pin_title_featured(e,r,i,t,n)}else{jQuery("#overlay-title-"+i.id).sf_open_pin_title(e,r,i)}}},mouseout:function(e,t,n){if(o=="true"){jQuery(".overlay-featured-wrapper-"+n.id).stop().animate({width:"40px",height:"40px",left:"81px",top:"-20px",opacity:.6},{duration:250,easing:"easeInOutBack"})}else{jQuery("#overlay-title-"+n.id).stop().animate({opacity:0,top:"10px"},{duration:100,easing:"easeInOutQuint",complete:function(){jQuery(this).hide()}})}},click:function(r,i,u){if(sf.overlays){var a=r.getPosition();if(jQuery("#map-overlay-"+u.id).length>0||jQuery(window).width()<=700){if(parseInt(jQuery("#overlay-title-"+u.id).css("opacity"))>.95){window.location=s;return false}if(o=="true"){window.location=s;return false}else{jQuery("#overlay-title-"+u.id).sf_open_pin_title(r,i,u)}}if(jQuery(window).width()>=700&&jQuery(window).width()<1e3){var f=parseInt("-"+sf.overlays_width/2);jQuery("#slider-map").map_position_offset(f,0,a)}else{if(typeof sf_map!="undefined"){if(typeof sf_map.search_visibile!="undefined"){var l=parseInt(jQuery("#search").outerHeight())/2;if(sf_map.search_position=="Top"){l=-Math.abs(l)}jQuery("#slider-map").map_position_offset(0,l,a)}else{jQuery("#slider-map").gmap3("get").panTo(a)}}else{jQuery("#slider-map").gmap3("get").panTo(a)}}}else{window.location=s;return false}if(jQuery(window).width()>700){jQuery("#slider-map").openSpotOverlay(e,t,n)}}},callback:function(e){if(sf_map.pin_2x=="on"){e.setIcon({url:r,scaledSize:new google.maps.Size(parseInt(sf_map.pin_2x_w),parseInt(sf_map.pin_2x_h))})}if(typeof clusterManager!="undefined"){clusterManager.addMarker(e)}thisMarkerId=e.__gm_id;if(typeof a=="function"){a.call(this)}}},overlay:{latLng:[t,n],options:{content:l,offset:{y:-65,x:-100}},callback:function(t){if(o=="true"){var n=jQuery(t.getDOMElement()).find(".overlay-featured-wrapper");n.attr("id","featured-"+thisMarkerId+"-"+e);n.addClass("overlay-helper-"+thisMarkerId);n.css({opacity:.6});n.click(function(){window.location=s;return false});n.hover(function(){n.stop().animate({width:"75px",height:"75px",left:"62px",top:"-54px",opacity:1},{duration:250,easing:"easeInOutBack"});if(jQuery("#map-overlay-"+e).length==0){var r=t.getPosition();jQuery("#slider-map").openSpotOverlay(e,r.lat(),r.lng())}},function(){if(jQuery("#map-overlay-"+e).length==0){jQuery(".overlay-featured-wrapper-"+e).stop().animate({width:"40px",height:"40px",left:"81px",top:"-20px",opacity:.6},{duration:250,easing:"easeInOutBack"})}})}else{var r=jQuery(t.getDOMElement()).find(".overlay-title-wrapper");r.addClass("overlay-helper-"+thisMarkerId)}}}})},openSpotOverlay:function(e,t,n){var r=this;jQuery("#slider-map").removeOverlays();r.gmap3({overlay:{latLng:[t,n],options:{content:'<div id="map-overlay-'+e+'" class="map-overlay map-overlay-loading"><div class="overlay-inside"></div><span class="arrow"></span></div>',offset:{y:-30,x:25}},callback:function(t){overlayInt=setInterval(function(){if(jQuery("#map-overlay-"+e).length>0){clearInterval(overlayInt);var t=false;jQuery("#map-overlay-"+e).fadeIn(200,function(){t=true}).spin({lines:7,length:0,width:5,radius:5,corners:1,rotate:0,direction:1,speed:2.5,trail:64});overlayRequest=jQuery.ajax({url:sf.ajaxurl,type:"post",dataType:"json",data:{action:"get_overlay_markup",nonce:sf.get_overlay_markup,post_id:e},success:function(n){overlayFadeInt=setInterval(function(){if(t){clearInterval(overlayFadeInt);if(n.error){jQuery("#map-overlay-"+e).fadeOut(200,function(){jQuery(this).remove()});if(n.message){jQuery("#slider-map-message span").text(n.message).parent().fadeIn(300,function(){jQuery(this).delay(1500).fadeOut(300)})}}else{if(n.markup){var r=(n.height-30)/2;jQuery("#map-overlay-"+e).spin(false).stop().animate({height:n.height,top:"-"+r+"px"},{duration:200,ease:"easingInOutQuint",complete:function(){jQuery("#map-overlay-"+e).spin(false).children(".overlay-inside").html(n.markup).fadeIn(200)}})}}}},100)}})}},100)}}})},fixMapHeight:function(){var e=this;if(jQuery(window).width()<720){e.fixMapHeightResponsive();return false}if(typeof _sf_resize_handle_pos!="undefined"){return false}if(jQuery.cookie("_sf_map_height")!=undefined){var t=jQuery.cookie("_sf_map_height");jQuery("#slider, #slider-map").css({height:t+"px"});return false}var n=parseInt(jQuery(window).height())/100*80;e.css({height:n+"px"})},fixMapHeightResponsive:function(){var e=this;var t=parseInt(jQuery(window).height())/100*70;e.css({height:t+"px"})},searchShowOnHover:function(){var e=this;var t=e.children("#search");var n=false;e.hover(function(){n=true;var r=t.outerHeight();var i=r+70;e.stop().animate({height:i+"px"},{easing:"easeInOutCubic",duration:300});e.find(".up-arrow, .down-arrow").stop().animate({opacity:0},250)},function(){var t=true;n=false;if(e.find("select:focus").length>0&&navigator.userAgent.toLowerCase().indexOf("msie")!=-1){t=false;jQuery("#search-spots").one("submit",function(){e.stop().animate({height:"70px"},{easing:"easeInOutCubic",duration:300});e.find(".up-arrow, .down-arrow").stop().animate({opacity:1},250)})}if(jQuery(".pac-container").length>0){if(jQuery(".pac-container").is(":visible")){t=false}}if(t){e.stop().animate({height:"70px"},{easing:"easeInOutCubic",duration:300});e.find(".up-arrow, .down-arrow").stop().animate({opacity:1},250)}})},removeOverlays:function(){var e=this;if(typeof overlayRequest!="undefined"){overlayRequest.abort()}jQuery(".map-overlay, .overlay-cluster-wrapper").fadeOut(200,function(){jQuery(this).remove()});jQuery(".map-overlay").each(function(){var e=jQuery(this).attr("id").split("-");if(jQuery(".overlay-featured-wrapper-"+e[2]).length>0){jQuery(".overlay-featured-wrapper-"+e[2]).stop().animate({width:"40px",height:"40px",left:"81px",top:"-20px",opacity:.6},{duration:250,easing:"easeInOutBack"})}})},mapZoomIn:function(){var e=this;e.click(function(){var e=jQuery("#slider-map").gmap3("get");var t=e.getZoom();t++;if(t>=20){t=20}e.setZoom(t)})},mapZoomOut:function(){var e=this;e.click(function(){var e=jQuery("#slider-map").gmap3("get");var t=e.getZoom();t--;if(t<=2){t=2}e.setZoom(t)})},fitMapToBounds:function(e){var t=this;jQuery(this).gmap3({get:{name:"marker",all:true,tag:"spot",callback:function(e){var n=new google.maps.LatLngBounds;var r=new Array;jQuery.each(e,function(e,t){var i=t.getPosition();r[e]=new google.maps.LatLng(i.lat(),i.lng());n.extend(r[e])});if(e.length>0){t.gmap3("get").fitBounds(n);var i=t.gmap3("get").getZoom();if(i>=20){i=20}i--;if(i<2){i=2}t.gmap3("get").setZoom(i)}}}});if(typeof e!="undefined"){e.preventDefault()}return false},getDirections:function(e,t,n){if(typeof theDirections!="undefined"){theDirections.setMap(null)}var r=this;var i="";r.gmap3({get:{name:"marker",id:"cur_loc",callback:function(e){i=e}}});if(i){r.gmap3({get:{name:"marker",id:t,callback:function(e){var t=e;if(n=="DRIVING"){n=google.maps.DirectionsTravelMode.DRIVING}r.gmap3({getroute:{options:{origin:i.getPosition(),destination:t.getPosition(),travelMode:n},callback:function(e){if(!e){jQuery("#slider-map-message span").text("Directions from your location to here are not available.").parent().fadeIn(300,function(){jQuery(this).delay(1500).fadeOut(300)})}else{var n=new google.maps.LatLngBounds;var s=new Array;s[0]=new google.maps.LatLng(t.getPosition().lat(),t.getPosition().lng());s[1]=new google.maps.LatLng(i.getPosition().lat(),i.getPosition().lng());n.extend(s[0]);n.extend(s[1]);r.gmap3("get").fitBounds(n);r.gmap3({directionsrenderer:{options:{directions:e,draggable:true,suppressMarkers:true},callback:function(e){theDirections=e}}})}}}})}}})}e.preventDefault();return false},_sf_fit_all_pins_to_bound:function(){var e=this;var t=setInterval(function(){if(typeof _sf_all_pins_loaded!="undefined"){clearInterval(t);e.fitMapToBounds()}},50)},_sf_before_loading_spots:function(e){var t=this;t.find("*").hide();t.addClass("loading-content").spin({lines:11,length:11,width:5,radius:11,corners:1,speed:2,shadow:false,top:"50"});setTimeout(function(){if(typeof e=="function"){e.call(t)}},200)},_sf_after_loading_spots:function(e,t,n){var r=this;if(jQuery("#main-content .spinner").length==0){jQuery("#main-content")._sf_before_loading_spots()}var i=window.location.href;var s=jQuery.url(i).param();jQuery.each(s,function(t,n){if(t=="view"||t=="sort"||t=="per_page"&&t!=""){e+="&"+t+"="+n}});if(jQuery("#slider-map").length>0){jQuery("#slider-map")._sf_fit_all_pins_to_bound()}if(t){r._sf_load_results(e,t)}else{r._sf_load_results(e)}},_sf_load_results:function(e,t){var n=this;if(typeof t==undefined){t=new Array}var r=JSON.stringify(t);if(typeof loadingSpotsAjax!="undefined"){loadingSpotsAjax.abort()}loadingSpotsAjax=jQuery.ajax({url:e,type:"post",dataType:"HTML",data:{p_ids:t,nonce:"nope"},success:function(t){var n=t.split("<title>");n=n[1].split("</title>");n=n[0];var r=jQuery(t).find("#main-content").html();jQuery("#main-content").html(r).removeClass("loading-content");if(jQuery(t).find("#main-content .notify-me").length>0){jQuery("#main-content .notify-me")._sf_open_user_notification()}if(Modernizr.history){window.history.pushState({the_url:e,pageTitle:n},n,e)}jQuery("title").html(n);jQuery("#pagination a")._sf_pagination_click()}})},_sf_load_results_pop_state:function(e){var t=this;if(Modernizr.history){window.onpopstate=function(e){if(e.state!=null){window.location.href=e.state.the_url}else{if(typeof url_global_store!="undefined"){window.location.reload()}url_global_store=window.location.href}}}},_sf_list_view_click:function(){var e=this;e.click(function(e){if(jQuery(this).attr("class").indexOf("current")==-1){jQuery(this).parent().parent().find(".current").removeClass("current");jQuery(this).addClass("current");if(jQuery(this).attr("href").indexOf("grid")!=-1){jQuery.cookie("listing_view","Grid",{path:"/"});var t="spot-grid"}else{jQuery.cookie("listing_view","List",{path:"/"});var t="spot-list"}jQuery("#main-content ul#spots").stop().animate({opacity:0},200,function(){jQuery(this).attr("class",t);jQuery(this).stop().animate({opacity:1},200)})}e.preventDefault();return false})},_sf_change_per_page_view:function(){var e=this;var t=window.location.href;var n=e.val();var r=jQuery.url(n).param("per_page");var i=jQuery.url(t).param();var s="";jQuery.each(i,function(e,t){if(e!="per_page"&&e!="paged"&&e!=""){s+="&"+e+"="+t}});var o=t.split("?");if(o.length>1){var u=o[0]}else{var u=t}var a=jQuery.url(u).segment();var o="";var f="";jQuery.each(a,function(e,t){if(t=="page"){f=e+1}else{if(typeof f!=""&&e==f&&f!=0){}else{o+="/"+t}}});if(f!=""){var l=jQuery.url(u);u=l.attr("protocol")+"://"+l.attr("host")+o+"/"}var i=s+"&per_page="+r;if(i[0]=="&"){i=i.substr(1,i.length)}var c=u+"?"+i;jQuery("#main-content")._sf_before_loading_spots(function(){jQuery(this)._sf_load_results(c,jQuery("#_sf_post_ids").val())})},_sf_change_sort_view:function(){var e=this;var t=window.location.href;var n=e.val();var r=jQuery.url(n).param("sort");var i=jQuery.url(t).param();var s="";jQuery.each(i,function(e,t){if(e!="sort"&&e!="paged"&&e!=""){s+="&"+e+"="+t}});var o=t.split("?");if(o.length>1){var u=o[0]}else{var u=t}var a=jQuery.url(u).segment();var o="";var f="";jQuery.each(a,function(e,t){if(t=="page"){f=e+1}else{if(typeof f!=""&&e==f&&f!=0){}else{o+="/"+t}}});if(f!=""){var l=jQuery.url(u);u=l.attr("protocol")+"://"+l.attr("host")+o+"/"}var i=s+"&sort="+r;if(i[0]=="&"){i=i.substr(1,i.length)}var c=u+"?"+i;jQuery("#main-content")._sf_before_loading_spots(function(){jQuery(this)._sf_load_results(c,jQuery("#_sf_post_ids").val())})},_sf_pagination_click:function(){var e=this;e.click(function(e){var t=jQuery(this).attr("href");var n=window.location.href;var r=jQuery.url(n).param();var i="";if(jQuery.url(t).param("paged")!=undefined){r.paged=jQuery.url(t).param("paged")}jQuery.each(r,function(e,t){if(e!=""){i+="&"+e+"="+t}});var s=t.split("?");if(s.length>1){var o=s[0]}else{var o=t}var r=i;if(r[0]=="&"){r=r.substr(1,r.length)}if(r!=""){var u=o+"?"+r}else{var u=o}jQuery("#main-content")._sf_before_loading_spots(function(){jQuery(this)._sf_load_results(u,jQuery("#_sf_post_ids").val())});e.preventDefault();return false})},_sf_show_pin_on_map:function(e,t){jQuery("#slider-map").gmap3({get:{name:"marker",id:t,tag:"spot",callback:function(e){var t=e.getPosition();jQuery("html, body").stop().animate({scrollTop:0},300);var n=jQuery("#slider-map").gmap3("get");n.setCenter(t);n.setZoom(18)}}});e.preventDefault();return false},map_recenter:function(e){var t=this.gmap3("get");if(jQuery(window).width()>=1e3){var n=-470;var r=-15}if(jQuery(window).width()>=700&&jQuery(window).width()<1e3){var n=-270;var r=-15}if(jQuery(window).width()<700){var n=-130;var r=-15}var i=t.getProjection();var s=i.fromLatLngToPoint(e);var o=new google.maps.Point((typeof n=="number"?n:0)/Math.pow(2,t.getZoom())||0,(typeof r=="number"?r:0)/Math.pow(2,t.getZoom())||0);t.setCenter(t.getProjection().fromPointToLatLng(new google.maps.Point(s.x-o.x,s.y+o.y)))},map_position_offset:function(e,t,n){var r=this.gmap3("get");var i=r.getProjection();var s=i.fromLatLngToPoint(n);var o=new google.maps.Point((typeof e=="number"?e:0)/Math.pow(2,r.getZoom())||0,(typeof t=="number"?t:0)/Math.pow(2,r.getZoom())||0);r.panTo(r.getProjection().fromPointToLatLng(new google.maps.Point(s.x-o.x,s.y+o.y)))},_sf_refresh_featured_markers:function(){var e=this;var t=new Array;var n=clusterManager.getClusters();jQuery.each(n,function(e,n){var r=n.getMarkers();if(r.length>1){jQuery.each(r,function(e,n){t.push(n.__gm_id)})}});jQuery(".overlay-featured-wrapper").each(function(){var e=jQuery(this).attr("id").split("-");if(t.indexOf(parseInt(e[1]))==-1){jQuery(this).show()}else{jQuery(this).hide()}})},_sf_map_resize:function(){var e=this;var t=jQuery("#slider");e.css({display:"block",opacity:0});e._sf_map_resize_fix_top();t.hover(function(){e.stop().animate({opacity:1},200)},function(){if(!e.is(":hover")){e.stop().animate({opacity:0},200)}});var n=300;e.draggable({axis:"y",start:function(e,t){_sf_resize_handle_pos=t.position.top;_sf_resize_map_height=parseInt(jQuery("#slider-map").height())},drag:function(t,r){var i=r.position.top-_sf_resize_handle_pos;console.log(r);var s=_sf_resize_map_height+i;if(s<n){s=n;e.draggable("disable")}jQuery("#slider-map, #slider").height(s)},stop:function(e,n){jQuery.cookie("_sf_map_height",parseInt(jQuery("#slider-map").height()),{path:"/"});var r=t.gmap3("get")}})},_sf_map_resize_fix_top:function(){var e=this;var t=jQuery("#slider");var n=t.height()-40;if(sf_map.search_position=="Bottom"){n=n-jQuery("#search").outerHeight()}e.css({top:n})},_sf_if_dropdown:function(e,t,n){var r=this;var i=jQuery("#search-spots ."+e);var s=r.children("option:selected").val();if(t.indexOf(s)!=-1){i.fadeIn(200)}else{i.hide()}if(r.children("option:selected").val()==""){if(t.indexOf("all")!=-1){i.fadeIn(200)}}r.change(function(){var e=jQuery(this).children("option:selected").val();if(t.indexOf(e)!=-1){i.fadeIn(200)}else{i.hide()}if(jQuery(this).children("option:selected").val()==""){if(t.indexOf("all")!=-1){i.fadeIn(200)}}})},_sf_if_check:function(e,t){var n=this;var r=jQuery("#search-spots ."+e);if(n.is(":checked")){r.fadeIn(200)}else{r.hide()}n.parent().click(function(){if(n.is(":checked")){r.fadeIn(200)}else{r.hide()}})},_sf_draw_radius:function(e,t,n,r,i,s,o){jQuery("#search-spots")._sf_destroy_radius();var u=this;var a=this.gmap3("get");u.gmap3({clear:{tag:["radiusCircle","radiusCenter","radiusResizer"]}});if(o=="destroy"||e==null){jQuery("#_sf_radius_field").val("");jQuery("#_sf_enable_radius_search").val("");jQuery("#_sf_radius_lat_from").val("");jQuery("#_sf_radius_lat_to").val("");jQuery("#_sf_radius_lng_from").val("");jQuery("#_sf_radius_lng_to").val("");jQuery("#_sf_radius_distance").val("");jQuery("#_sf_radius_center_lat").val("");jQuery("#_sf_radius_center_lng").val("");jQuery("._sf_ignore_sel_radius").val("");jQuery("._sf_ignore_sel").val("");jQuery("._sf_ignore_sel_parent").val("");return true}console.log("draw");if(r=="Kilometres"){radius_metres=e*1e3}else{radius_metres=e*1609.344}u.gmap3({circle:{options:{center:[t,n],radius:radius_metres,fillColor:sf.primary_color,strokeColor:sf.primary_color,fillOpacity:.05,strokeWeight:3,strokeOpacity:.15,clickable:false},tag:"radiusCircle"},overlay:{latLng:[t,n],options:{content:'<div class="_sf_radius_center" style="background: '+sf.primary_color+';"></div>',offset:{x:-6,y:-6}},tag:"radiusCenter"}});u.gmap3({get:{name:"circle",tag:"radiusCircle",callback:function(e){sfTheCircleRadius=e}}});jQuery("._sf_ignore_sel_"+i).val(s);var f=sfTheCircleRadius.getBounds();jQuery("#_sf_enable_radius_search").val("true");jQuery("#_sf_radius_lat_from").val(f.getSouthWest().lat());jQuery("#_sf_radius_lat_to").val(f.getNorthEast().lat());jQuery("#_sf_radius_lng_from").val(f.getSouthWest().lng());jQuery("#_sf_radius_lng_to").val(f.getNorthEast().lng());jQuery("#_sf_radius_distance").val(e);jQuery("#_sf_radius_center_lat").val(sfTheCircleRadius.getCenter().lat());jQuery("#_sf_radius_center_lng").val(sfTheCircleRadius.getCenter().lng());jQuery("#_sf_radius_field").val(i);if(sf.enable_radius_resizing=="on"){var l=sfTheCircleRadius.getBounds();if(l){var c=l.getSouthWest();var h=c.lng();var p=sfTheCircleRadius.getCenter().lat();u.gmap3({marker:{tag:"radiusResizer",options:{position:new google.maps.LatLng(p,h),icon:{url:sf.radius_resizing_icon,scaledSize:new google.maps.Size(20,20),anchor:{x:10,y:10}},draggable:true},events:{drag:function(e){var t=e.getPosition();var n=sfTheCircleRadius.getCenter();var r=6371;var i=(n.lat()-t.lat())*Math.PI/180;var s=(n.lng()-t.lng())*Math.PI/180;var o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(n.lat()*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);var u=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));var a=r*u;var f=a*1e3;sfTheCircleRadius.setRadius(f);sfTheCircleRadius.setOptions({fillOpacity:.2,strokeOpacity:.5})},dragend:function(e){jQuery("#_sf_ignore_sel_"+i).val(s);var t=sfTheCircleRadius.getBounds();jQuery("#_sf_enable_radius_search").val("true");jQuery("#_sf_radius_lat_from").val(t.getSouthWest().lat());jQuery("#_sf_radius_lat_to").val(t.getNorthEast().lat());jQuery("#_sf_radius_lng_from").val(t.getSouthWest().lng());jQuery("#_sf_radius_lng_to").val(t.getNorthEast().lng());var n=e.getPosition();var r=sfTheCircleRadius.getCenter();var o=6371;var u=(r.lat()-n.lat())*Math.PI/180;var a=(r.lng()-n.lng())*Math.PI/180;var f=Math.sin(u/2)*Math.sin(u/2)+Math.cos(n.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);var l=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));var c=o*l;jQuery("#_sf_radius_distance").val(c);jQuery("#_sf_radius_center_lat").val(r.lat());jQuery("#_sf_radius_center_lng").val(r.lng());jQuery("#_sf_radius_field").val(i);jQuery("#search-spots").submit()},mouseover:function(e){sfTheCircleRadius.setOptions({fillOpacity:.2,strokeOpacity:.5})},mouseout:function(e){sfTheCircleRadius.setOptions({fillOpacity:.05,strokeOpacity:.2})}},callback:function(e){if(typeof clusterManager!=="undefined"){clusterManager.removeMarker(e)}}}})}}},_sf_destroy_radius:function(){var e=this;e.gmap3({clear:{tag:["radiusCircle","radiusCenter","radiusResizer"]}})},_sf_check_for_radius:function(e){var t=this;if((t.find("option:selected").val()==""||t.find("option:selected").val()==0||t.find("option:selected").val()=="undefined")&&jQuery("#_sf_radius_field").val()==e){jQuery("#slider-map")._sf_draw_radius(null,null,null,null,null,null,"destroy")}},_sf_show_cluster_markers:function(e,t){var n=this;var r="";jQuery("#slider-map").removeOverlays();jQuery.each(t,function(e,t){var n=t.__gm_id;if(jQuery(".overlay-helper-"+n).attr("class").indexOf("featured")!=-1){var i=jQuery(".overlay-helper-"+n+" img").attr("title");var s=jQuery(".overlay-helper-"+n+" a").attr("href")}else{var i=jQuery(".overlay-helper-"+n+" .title").text();var s=jQuery(".overlay-helper-"+n+" a").attr("href")}r+='<li><a href="'+s+'" title="'+i+'">'+i+"</a></li>"});n.gmap3({overlay:{latLng:[e.lat(),e.lng()],options:{content:'<div class="overlay-cluster-wrapper"><div class="overlay-cluster"><ul>'+r+'</ul><span class="arrow"></span></div></div>',offset:{x:30,y:-125}},callback:function(e){var t=jQuery(e.getDOMElement()).find(".overlay-cluster-wrapper .overlay-cluster");t.css({display:"block",opacity:0}).stop().animate({opacity:0},5,function(){var e=t.outerHeight();t.css({"margin-top":"-"+(e/2-7)+"px",left:"-20px"}).stop().animate({left:0,opacity:1},200)})}}})},sf_open_pin_title_featured:function(e,t,n,r,i){jQuery(".overlay-featured-wrapper-"+n.id).stop().animate({width:"75px",height:"75px",left:"62px",top:"-54px",opacity:1},{duration:250,easing:"easeInOutBack"});jQuery("#overlay-title-"+n.id).css({display:"block",opacity:0});var s=jQuery("#overlay-title-"+n.id).height();if(s>30){var o=34;var u=-20}else{var o=14;var u=0}jQuery("#slider-map").openSpotOverlay(n.id,r,i)},sf_open_pin_title:function(e,t,n){jQuery("#overlay-title-"+n.id).css({display:"block",opacity:0});var r=jQuery("#overlay-title-"+n.id).height();var i=20;if(r>30){var s=34}else{var s=14}jQuery("#overlay-title-"+n.id).css({top:s+"px"}).stop().animate({opacity:1,top:i+"px"},{duration:150,easing:"easeInOutQuint"})}})})(jQuery);jQuery.urlParam=function(e){var t=(new RegExp("[\\?&]"+e+"=([^&#]*)")).exec(window.location.href);console.log(t);if(t==null){return null}else{return t[1]||0}};(function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:true};t.window=function(t){return e(window)._scrollable()};e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})};e.fn.scrollTo=function(r,i,s){if(typeof i=="object"){s=i;i=0}if(typeof s=="function")s={onAfter:s};if(r=="max")r=9e9;s=e.extend({},t.defaults,s);i=i||s.duration;s.queue=s.queue&&s.axis.length>1;if(s.queue)i/=2;s.offset=n(s.offset);s.over=n(s.over);return this._scrollable().each(function(){function d(e){u.animate(c,i,s.easing,e&&function(){e.call(this,a,s)})}if(r==null)return;var o=this,u=e(o),a=r,l,c={},p=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)l=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),f="scroll"+r,v=o[f],m=t.max(o,n);if(l){c[f]=l[i]+(p?0:v-u.offset()[i]);if(s.margin){c[f]-=parseInt(a.css("margin"+r))||0;c[f]-=parseInt(a.css("border"+r+"Width"))||0}c[f]+=s.offset[i]||0;if(s.over[i])c[f]+=a[n=="x"?"width":"height"]()*s.over[i]}else{var y=a[i];c[f]=y.slice&&y.slice(-1)=="%"?parseFloat(y)/100*m:y}if(s.limit&&/^\d+$/.test(c[f]))c[f]=c[f]<=0?0:Math.min(c[f],m);if(!e&&s.queue){if(v!=c[f])d(s.onAfterFirst);delete c[f]}});d(s.onAfter)}).end()};t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}})(jQuery)