(function(e){e.fn.extend({_sf_listings_review_stars:function(){var e=this;var t=e.find("i");var n=e.find("input");var r="icon-star";var i="icon-star-empty";t.css({opacity:.3});t.hover(function(){var t=jQuery(this).index();e.find("i:lt("+t+")").attr("class",r).css({opacity:1});jQuery(this).attr("class",r).css({opacity:1});e.find("i:gt("+t+")").attr("class",i).css({opacity:.3})},function(){if(n.val()==""){e.find("i").attr("class",i).css({opacity:.3})}else{var t=n.val()-1;e.find("i:lt("+t+"), i:eq("+t+")").attr("class",r).css({opacity:1});e.find("i:gt("+t+")").attr("class",i).css({opacity:.3})}});t.click(function(){var e=jQuery(this).index();n.val(e+1)})},_sf_review_submit:function(){var e=this;var t=this.find('input[type="submit"]');e.submit(function(n){jQuery("input.error, textarea.error").removeClass("error");jQuery("small.error").fadeOut(300);var r=false;e.find("input, textarea").each(function(){if(jQuery(this).val()==""){r=true;jQuery(this).addClass("error").siblings("small").fadeIn(300,function(){jQuery(this).delay(3e3).fadeOut(300)})}});if(r===false){e.children("*:not(.spinner)").stop().animate({opacity:.2},300);e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});t.attr("disabled","disabled");jQuery.ajax({url:sf_r.ajaxurl,type:"post",dataType:"json",data:{action:"sf_rating",nonce:sf_r._sf_rating_nonce,data:e.serialize()},success:function(n){console.log(n);if(n.error){e.spin(false).children("*").stop().animate({opacity:1},300);t.removeAttr("disabled");if(n.error_message){e.prepend('<p class="error" style="display:none"><br><small>'+n.error_message+"</small></p>");e.children("p.error").slideDown(250,function(){jQuery(this).delay(3e3).slideUp(250,function(){jQuery(this).remove()})})}if(n.error_fields.length>0){jQuery.each(n.error_fields,function(e,t){jQuery("#"+t.field).parent().addClass("error").append("<small>"+t.message+"</small>");setTimeout(function(){jQuery("#"+t.field).parent().removeClass("error").find("small:not(.error)").remove()},3e3)})}}else{e.fadeOut(300,function(){e.html("<h4>"+n.message+"</h4>").fadeIn(300)})}}})}n.preventDefault();return false})},_sf_load_more_reviews:function(e){var t=this;var n=t.children("a");var r=jQuery("#reviews > ul");n.click(function(e){var i=r.children("li").length;n.hide();t.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});jQuery.ajax({url:n.attr("href"),type:"get",dataType:"html",success:function(e){var i=jQuery(e).find("#reviews ul").html();r.append(i);if(jQuery(e).find("#reviews-load-more").length==0){jQuery("#reviews-load-more").remove()}else{n.attr("href",jQuery(e).find("#reviews-load-more a").attr("href")).show();t.spin(false)}}});e.preventDefault();return false})},sf_report_rating:function(e,t){var n=this;var r=n.closest("li");r.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9}).children("*:not(.spinner)").animate({opacity:.3},200);jQuery.ajax({url:sf_r.ajaxurl,type:"post",dataType:"json",data:{action:"sf_report_review",nonce:sf_r._sf_report_review_nonce,post_id:t},success:function(e){if(e.error){alert(e.error)}else{r.spin(false).children("*:not(.spinner)").animate({opacity:1},200);r.find(".rating-comment").html(e.message)}}});e.preventDefault();return false},sf_trash_rating:function(e,t){var n=this;var r=n.closest("li");r.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9}).children("*:not(.spinner)").animate({opacity:.3},200);jQuery.ajax({url:sf_r.ajaxurl,type:"post",dataType:"json",data:{action:"sf_trash_review",nonce:sf_r._sf_trash_review_nonce,post_id:t},success:function(e){if(e.error){alert(e.error)}else{r.spin(false).children("*:not(.spinner)").animate({opacity:1},200);r.slideUp(300)}}});e.preventDefault();return false},sf_restore_rating:function(e,t){var n=this;var r=n.closest("li");r.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9}).children("*:not(.spinner)").animate({opacity:.3},200);jQuery.ajax({url:sf_r.ajaxurl,type:"post",dataType:"json",data:{action:"sf_restore_review",nonce:sf_r._sf_restore_review_nonce,post_id:t},success:function(e){if(e.error){alert(e.error)}else{r.spin(false).children("*:not(.spinner)").animate({opacity:1},200);r.removeClass("review-moderate").find(".rating-comment").html(e.message)}}});e.preventDefault();return false}})})(jQuery)