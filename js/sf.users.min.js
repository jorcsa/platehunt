function IsJsonString(e){try{JSON.parse(e)}catch(t){return false}return true}(function(e){e.fn.extend({_sf_logout:function(e){this.css({opacity:.8}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,left:-33});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_logout",nonce:sf_us._sf_logout_nonce},success:function(e){window.location.reload()}});e.preventDefault();return false},_sf_login:function(){var e=this;e.submit(function(t){var n=e.find('input[name="username"]');var r=e.find('input[name="password"]');var i=e.find('input[type="submit"]');e.children("*").stop().animate({opacity:.3});i.attr("disabled","disabled");e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});e.find("small.error, p.error small").remove();e.find("p.error").removeClass("error");jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_login",nonce:sf_us._sf_login_nonce,username:n.val(),password:r.val()},success:function(t){e.children("*").stop().animate({opacity:1});i.removeAttr("disabled");e.spin(false);if(t.error){e.prepend('<p><small class="error" style="display: block;">'+t.message+"</small></p>");e.children("small").fadeIn(300)}else{e.prepend('<p><small class="success" style="display: block;">'+t.message+"</small></p>");e.children("small").fadeIn(300,function(){jQuery(this).delay(3e3).fadeOut(300,function(){jQuery(this).remove()})});e.find('input[type="password"]').val("");window.location.reload()}}});t.preventDefault();return false})},_sf_register:function(){var e=this;e.submit(function(t){var n=e.find('input[name="username"]');var r=e.find('input[name="email"]');var i=e.find('input[type="submit"]');e.children("*").stop().animate({opacity:.3});i.attr("disabled","disabled");e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});e.find("small.error, p.error small").remove();e.find("p.error").removeClass("error");jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_register",nonce:sf_us._sf_register_nonce,username:n.val(),email:r.val()},success:function(t){e.children("*").stop().animate({opacity:1});i.removeAttr("disabled");e.spin(false);if(t.error){e.prepend('<p><small class="error" style="display: block;">'+t.message+"</small></p>");e.children("small").fadeIn(300)}else{e.prepend('<p><small class="success" style="display: block;">'+t.message+"</small></p>");e.children("small").fadeIn(300,function(){jQuery(this).delay(3e3).fadeOut(300,function(){jQuery(this).remove()})});e.find('input[type="password"]').val("")}}});t.preventDefault();return false})},_sf_lost_password:function(){var e=this;e.submit(function(t){var n=e.find('input[name="email_user"]');var r=e.find('input[type="submit"]');e.children("*").stop().animate({opacity:.3});r.attr("disabled","disabled");e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});e.find("small.error, p.error small").remove();e.find("p.error").removeClass("error");jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_lost_password",nonce:sf_us._sf_lost_password_nonce,input:n.val(),page_url:window.location.href},success:function(t){e.children("*").stop().animate({opacity:1});r.removeAttr("disabled");e.spin(false);if(t.error){e.prepend('<p><small class="error" style="display: block;">'+t.message+"</small></p>");e.find("small").fadeIn(300)}else{e.prepend('<p><small class="success" style="display: block;">'+t.message+"</small></p>");e.children("small").fadeIn(300,function(){jQuery(this).delay(3e3).fadeOut(300,function(){jQuery(this).remove()})});n.val("")}}});t.preventDefault();return false})},_sf_reset_password:function(){var e=this;e.submit(function(t){var n=e.find('input[name="password"]');var r=e.find('input[name="password_confirm"]');var i=e.find('input[name="username"]');var s=e.find('input[type="submit"]');e.children("*").stop().animate({opacity:.3});s.attr("disabled","disabled");e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});e.find("small.error, p.error small").remove();e.find("p.error").removeClass("error");jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_reset_password",nonce:sf_us._sf_reset_password_nonce,password:n.val(),password_c:r.val(),user:i.val()},success:function(t){e.children("*").stop().animate({opacity:1});s.removeAttr("disabled");e.spin(false);if(t.error){e.prepend('<p><small class="error" style="display: block;">'+t.message+"</small></p>");e.find("small").fadeIn(300)}else{e.prepend('<p><small class="success" style="display: block;">'+t.message+"</small></p>");e.find("small").fadeIn(300,function(){jQuery(this).delay(3e3).fadeOut(300,function(){window.location.reload();jQuery(this).remove()})})}}});t.preventDefault();return false})},_sf_sortable_gallery:function(){var e=this;var t=e.siblings("input");e.sortable({items:"> li",revert:100,stop:function(t,n){e._sf_refresh_gallery()}})},_sf_refresh_gallery:function(){var e=this;var t=e.siblings("input");var n={};e.children("li").each(function(e,t){n[e]=jQuery(this).find(".id").text()});var r=JSON.stringify(n);t.val(r)},_sf_sortable_gallery_remove:function(){var e=this.parent();var t=e.parent();e.fadeOut(200,function(){jQuery(this).remove();t._sf_refresh_gallery()})},_sf_upload_gallery:function(e){var t=this;var n=jQuery("#_sf_gallery_upload_button");var r=jQuery("#_sf_gallery_images");var i=jQuery(this).attr("id");isUploadingImage=false;formAction=new Object;formAction.name="action";formAction.value="_sf_gallery_upload";formPostId=new Object;formPostId.name="post_id";formPostId.value=e;formNonce=new Object;formNonce.name="nonce";formNonce.value=sf_us._sf_gallery_upload_nonce;var s=new Array(formAction,formPostId,formNonce);var o=t.fileupload({url:sf_us.ajaxurl,dataType:"json",type:"post",sequentialUploads:true,formData:s,acceptFileTypes:/(\.|\/)(gif|jpe?g|png|GIF|JPE?G|PNG)$/i,done:function(e,t){isUploadingImage=false;if(t.result.error){r.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+t.result.message+"</small>");r.parent().find("small").delay(3e3).fadeOut(300,function(){jQuery(this).remove()});r.spin(false).children("li").css({opacity:1})}else{jQuery("<li/>").appendTo(r);var n=r.children("li:last");n.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});n.append('<span class="hidden id">'+t.result.image.id+"</span>");var i=new Image;jQuery(i).attr("src",t.result.image.thumb).load(function(){n.append('<img src="'+t.result.image.thumb+'" alt="" title="" style="display: none;" /><span class="remove" onclick="jQuery(this)._sf_sortable_gallery_remove();"><i class="icon-trash"></i></span>');n.find("img").fadeIn(300);n.spin(false)});r._sf_sortable_gallery();r._sf_refresh_gallery()}}}).on("fileuploadadd",function(e,t){isUploadingImage=true;n.css({opacity:.8}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,left:-33});var i=t.originalFiles.length;var s=r.children("li").length;var u=sf_us._sf_gallery_upload_count;if(jQuery("#_sf_gallery_extra").length>0){u=sf_us._sf_gallery_upload_count_extra}u=u-s;if(i>u){r.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+sf_us._sf_gallery_upload_count_message+"</small>");r.parent().find("small").delay(3e3).fadeOut(300,function(){jQuery(this).remove()});n.removeAttr("disabled").css({opacity:1}).spin(false);isUploadingImage=false;o.abort();return false}else{n.parent().siblings(".upload-bar, .upload-bar-file").fadeIn(200);t.submit()}}).on("fileuploadprogressall",function(e,t){var r=parseInt(t.loaded/t.total*100,10);n.parent().siblings(".upload-bar").find("span").css("width",r+"%");if(r==100){n.parent().siblings(".upload-bar, .upload-bar-file").fadeOut(200);n.parent().siblings(".upload-bar").find("span").css("width","6px");n.spin(false).css({opacity:1})}}).on("fileuploadsend",function(e,t){var r=t.files;n.parent().siblings(".upload-bar-file").text(r[0].name)})},_sf_upload_file_submission:function(e,t,n){var r=this;var i=jQuery("#_sf_upload_file_submission_"+t);var s=jQuery("#_sf_submission_field_"+t+"_list");var o=jQuery(this).attr("id");isUploadingFile=false;formAction=new Object;formAction.name="action";formAction.value="_sf_field_submission_upload";formPostId=new Object;formPostId.name="post_id";formPostId.value=e;formFieldId=new Object;formFieldId.name="field_id";formFieldId.value=t;formNonce=new Object;formNonce.name="nonce";formNonce.value=sf_us._sf_field_submission_upload_nonce;var u=new Array(formAction,formPostId,formNonce,formFieldId);var a=r.fileupload({url:sf_us.ajaxurl,dataType:"json",type:"post",sequentialUploads:true,formData:u,acceptFileTypes:/(\.|\/)(pdf|txt|doc|csv|pps|xla|xls|xlt|xlw|docx|xlsx|pptx|PDF|TXT|DOC|CSV|PPS|XLA|XLS|XLT|XLW|DOCX|XLSX|PPTX)$/i,done:function(e,t){isUploadingImage=false;if(t.result.error){s.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+t.result.message+"</small>");s.parent().find("small").delay(3e3).fadeOut(300,function(){jQuery(this).remove()});s.spin(false).children("li").css({opacity:1})}else{console.log(t);s.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9}).children("li").css({opacity:.3});s.find("li._sf_box_clone").clone().appendTo(s);var n=s.find("li._sf_box_clone:last-child");n.find(".head .left").text(t.result.file.name);n.find(".filetype").text(t.result.file.type);n.find("input._sf_submission_file").val(t.result.file.name);n.find(".filesize").text(parseInt(t.result.file.size/1024)+" kb");s.spin(false).children("li").css({opacity:1});n.css({display:"none"}).removeClass("_sf_box_clone").slideDown(200);n.find('input[name="_sf_submission_attachment_id"]').val(t.result.file.id);s._sf_refresh_submission_file()}}}).on("fileuploadadd",function(e,t){isUploadingImage=true;i.css({opacity:.8}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,left:-33});var r=t.originalFiles.length;var o=s.children("li:not(._sf_box_clone)").length;var u=n;u=u-o;if(r>u){s.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+sf_us._sf_field_submission_upload_count_message+"</small>");s.parent().find("small").delay(3e3).fadeOut(300,function(){jQuery(this).remove()});i.removeAttr("disabled").css({opacity:1}).spin(false);isUploadingImage=false;a.abort();return false}else{i.parent().siblings(".upload-bar, .upload-bar-file").fadeIn(200);t.submit()}}).on("fileuploadprogressall",function(e,t){var n=parseInt(t.loaded/t.total*100,10);i.parent().siblings(".upload-bar").find("span").css("width",n+"%");if(n==100){i.parent().siblings(".upload-bar, .upload-bar-file").fadeOut(200);i.parent().siblings(".upload-bar").find("span").css("width","6px");i.spin(false).css({opacity:1})}}).on("fileuploadsend",function(e,t){var n=t.files;i.parent().siblings(".upload-bar-file").text(n[0].name)})},_sf_refresh_submission_file:function(){var e=this;var t=e.siblings("input");var n={};e.children("li:not(._sf_box_clone)").each(function(e,t){var r={};r["ID"]=jQuery(this).find('input[name="_sf_submission_attachment_id"]').val();r["title"]=jQuery(this).find("._sf_submission_file").val();r["desc"]=jQuery(this).find("._sf_submission_description").val();r["size"]=jQuery(this).find(".filesize").text();n[e]=r});var r=JSON.stringify(n);t.val(r)},_sf_submission_file_update:function(){var e=this.parent().parent().parent().parent();var t=e.find("._sf_submission_file");var n=e.find(".head .left");var r=e.parent();if(t.val()==""){t.val("-").siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)})}n.text(t.val());r._sf_refresh_submission_file()},_sf_submission_file_remove:function(e){var t=this.parent().parent();var n=t.find("ul._sf_submission_field_file_list");t.slideUp(200,function(){jQuery(this).remove();n._sf_refresh_submission_file()})},_sf_upload_profile_pic:function(){var e=jQuery("#_sf_user_profile_pic_upload");var t=jQuery("#_sf_user_profile_pic_upload_button");var n="_sf_user_profile_pic_upload";var r=this;var i=jQuery("#_sf_user_profile_image");var s=jQuery("#_sf_user_profile_pic");isUploadingImage=false;formAction=new Object;formAction.name="action";formAction.value="_sf_gallery_upload";formPostId=new Object;formPostId.name="post_id";formPostId.value="";formPostThumb=new Object;formPostThumb.name="thumb_size";formPostThumb.value="92_108";formNonce=new Object;formNonce.name="nonce";formNonce.value=sf_us._sf_gallery_upload_nonce;var o=new Array(formAction,formPostId,formNonce,formPostThumb);var u=e.fileupload({url:sf_us.ajaxurl,dataType:"json",type:"post",sequentialUploads:true,formData:o,acceptFileTypes:/(\.|\/)(gif|jpe?g|png|GIF|JPE?G|PNG)$/i,done:function(e,t){isUploadingImage=false;if(t.result.error){r.prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+t.result.message+"</small>");r.find("small").delay(3e3).fadeOut(300,function(){jQuery(this).remove()});i.spin(false).children("img").css({opacity:1})}else{i.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});var n=new Image;jQuery(n).attr("src",t.result.image.thumb).load(function(){i.html("");i.append('<img src="'+t.result.image.thumb+'" alt="" title="" style="display: none;" />');i.find("img").fadeIn(300);i.spin(false)});s.val(t.result.image.id)}}}).on("fileuploadadd",function(e,n){isUploadingImage=true;t.css({opacity:.8}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9});r.find(".upload-bar, .upload-bar-file").fadeIn(200);n.submit()}).on("fileuploadprogressall",function(e,n){var i=parseInt(n.loaded/n.total*100,10);r.find(".upload-bar").find("span").css("width",i+"%");if(i==100){r.find(".upload-bar, .upload-bar-file").fadeOut(200);r.find(".upload-bar").find("span").css("width","6px");t.spin(false).css({opacity:1})}}).on("fileuploadsend",function(e,t){var n=t.files;r.find(".upload-bar-file").text(n[0].name)});jQuery("#_sf_user_profile_pic_remove").click(function(){s.val("");i.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});i.find("img").fadeOut(300);var e=new Image;jQuery(e).attr("src",sf_us._sf_us_placeholder).load(function(){i.find("img").remove();i.append(this);i.spin(false)})})},_sf_remove_tag:function(){var e=this.parent().parent().parent();var t=this.parent().parent();t.fadeOut(100,function(){jQuery(this).remove();e._sf_refresh_tags()})},_sf_refresh_tags:function(){var e=this;var t=jQuery("#_sf_tags_input");var n={};e.children("li").each(function(e,t){var r=jQuery(this).text();var i=false;jQuery.each(n,function(e,t){if(t==r){i=true}});if(i===false){n[e]=r}});var r=JSON.stringify(n);t.val(r)},_sf_adding_tags_input:function(){var e=this;var t=jQuery("#_sf_tags_list");e.keydown(function(n){if(n.which==13){theVal=e.val();t._sf_add_tag(theVal);e.val("");n.preventDefault();return false}})},_sf_add_tag:function(e){var t=this;var n=jQuery("#_sf_tags_input");var r=0;if(e==""){t.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+sf_us._sf_tags_empty_message+"</small>");t.parent().find("small").delay(2e3).fadeOut(300,function(){jQuery(this).remove()});return false}if(IsJsonString(n.val())===true){var i=jQuery.parseJSON(n.val());jQuery.each(i,function(e,t){r++})}if(r<sf_us._sf_tags_count||jQuery("#_sf_tags_extra").length>0&&r<sf_us._sf_tags_count_extra){var s=false;if(IsJsonString(n.val())===true){jQuery.each(i,function(t,n){if(n==e){s=true}})}if(s===true){var o=sf_us._sf_tags_exist_message;t.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+o+"</small>");t.parent().find("small").delay(2e3).fadeOut(300,function(){jQuery(this).remove()})}else{t.append('<li><span><i class="icon-minus" onclick="jQuery(this)._sf_remove_tag();"></i></span>'+e+"</li>");t._sf_refresh_tags()}}else{var o=sf_us._sf_tags_count_message;if(jQuery("#_sf_tags_extra").length>0){o=sf_us._sf_tags_count_message_extra}t.parent().prepend('<small class="error" style="margin-top: 0; margin-bottom: 15px;">'+o+"</small>");t.parent().find("small").delay(2e3).fadeOut(300,function(){jQuery(this).remove()})}},_sf_location_get_pinpoint:function(){var e=jQuery("#_sf_address");var t=jQuery("#_sf_location_map");var n=jQuery("#_sf_latitude");var r=jQuery("#_sf_longitude");if(e.val()!=""){var i=new google.maps.Geocoder;var s=i.geocode({address:e.val()},function(i,s){if(s==google.maps.GeocoderStatus.OK){lat=i[0].geometry.location.lat();lng=i[0].geometry.location.lng();n.val(lat);r.val(lng);jQuery(t).gmap3({get:{name:"marker",all:true,callback:function(e){jQuery.each(e,function(e,t){t.setMap(null)})}},map:{options:{zoom:14,center:new google.maps.LatLng(lat,lng)}},marker:{values:[{latLng:[lat,lng]}],options:{draggable:true},events:{mouseup:function(e,t,i){var s=e.getPosition();var o=s.lat();var u=s.lng();n.val(o);r.val(u)}}}})}else{alert('Could not pinpoint "'+e.val()+'"')}})}},_sf_save_spot:function(e,t,n){var r=jQuery("#_sf_spot");var i=this;i.css({opacity:.8}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,left:-33});tinyMCE.triggerSave();tinyMCE.triggerSave();jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_save",nonce:sf_us._sf_save_nonce,data:r.serialize(),post_id:e},success:function(e){if(typeof n=="function"){n.call(this)}if(typeof t=="undefined"){if(e.error===true){i.css({opacity:1}).spin(false);jQuery("#message").removeClass("success").addClass("error").find("span").text(sf_us.error_message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(300,function(){jQuery(this).delay(2e3).slideUp(300)});jQuery.each(e.error_fields,function(e,t){if(t.inside){jQuery("#"+t.field_id).find(".tooltip").text(t.message).fadeIn(200,function(){jQuery(this).delay(7e3).fadeOut(200)});jQuery("#"+t.field_id).parent().slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}})}else{i.css({opacity:1}).spin(false);jQuery("#message").removeClass("error").addClass("success").find("span").text(sf_us._sf_draft_saved_message);jQuery("#message i").attr("class","icon-ok-circle");jQuery("#message").slideDown(300,function(){jQuery(this).delay(2e3).slideUp(300)})}}else{}}})},_sf_load_initial_dependents:function(e,t,n,r){var i=this;var s=this.find("select");var o=i.siblings("p.message");var u=new Array;e.find("option:selected").each(function(){u.push(jQuery(this).val())});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_load_dependent_fields",nonce:sf_us._sf_load_dependent_fields_nonce,parent:u,parent_id:t,dependent_id:n},success:function(e){console.log(e);if(typeof e.sections=="object"&&typeof e.sections.length=="undefined"){var t="";jQuery.each(e.sections,function(e,n){t+='<optgroup label="'+n.label+'">';if(n.fields.length>0){jQuery.each(n.fields,function(e,n){t+='<option value="'+n.id+"";if(s.parent().parent().find('input[name="selected_dependents"]').length>0){var r=jQuery.parseJSON(decodeURIComponent(s.parent().parent().find('input[name="selected_dependents"]').val()));if(jQuery.inArray(n.id,r)!=-1){t+='" selected="selected'}}t+='">'+n.label+"</option>"})}else{t+='<option value="null">-</option>'}t+="</optgroup>"})}else{t=""}if(t!=""){o.hide();s.html(t);i.show();var n=s.find("option:selected");i.find(".select-replace span").text(n.text())}else{o.show();s.html("");i.hide()}if(typeof r=="function"){r.call(this)}}})},_sf_switch:function(){var e=this;var t=this.find("input");var n=this.find("._sf_switch_on");var r=this.find("._sf_switch_handle");n.css({display:"block",opacity:0});if(t.val()=="on"){e.addClass("_sf_switch_checked");n.css({opacity:1})}e.click(function(){if(t.val()=="on"){r.stop().animate({right:"51px"},{duration:200,easing:"easeInOutQuint"});n.stop().animate({opacity:0},{duration:200,easing:"easeInOutQuint"});t.val("off")}else{r.stop().animate({right:"2px"},{duration:200,easing:"easeInOutQuint"});n.stop().animate({opacity:1},{duration:200,easing:"easeInOutQuint"});t.val("on")}})},_sf_custom_field_open:function(e){if(e.srcElement.className.indexOf("close")==-1&&e.srcElement.className.indexOf("cancel")==-1){var t=this.parent();var n=t.find(".inside");if(n.is(":visible")){n.slideUp(200)}else{n.slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}},_sf_custom_field_remove:function(e){var t=this.parent().parent();t.slideUp(200,function(){jQuery(this).remove();jQuery("#_sf_custom_fields_list")._sf_custom_field_refresh()})},_sf_custom_field_update:function(){var e=this.parent().parent().parent().parent();var t=e.find("._sf_custom_field_label");var n=e.find("._sf_custom_field_value");var r=e.find(".head .left");var i=jQuery("#_sf_custom_fields_list");if(t.val()==""){t.val("-").siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)})}if(n.val()==""){n.val("-").siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)})}r.text(t.val());i._sf_custom_field_refresh()},_sf_wpml_update_custom_field_translations:function(){var e=this;e.find("input").blur(function(){var t=false;e.children("li").each(function(){jQuery(this).find("input").each(function(){jQuery(this).parent().removeClass("error");if(jQuery(this).val().length==0){t=true;jQuery(this).parent().addClass("error");jQuery(this).siblings("small").fadeIn(200,function(){var e=jQuery(this);setTimeout(function(){e.fadeOut(200)},2e3)})}})});if(t===false){var n=jQuery("#_sf_custom_fields_input");var r={};e.children("li").each(function(e,t){var n={};n["label"]=jQuery(this).find(".label").val();n["value"]=jQuery(this).find(".value").val();r[e]=n});var i=JSON.stringify(r);n.val(i)}})},_sf_add_custom_field:function(){var e=this.parent().parent();var t=e.find("#_sf_custom_field_label");var n=e.find("#_sf_custom_field_value");var r=t.siblings("label").text();var i=n.siblings("label").text();var s=jQuery("#_sf_custom_fields_list");if(t.val()==""){t.siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)});return false}if(n.val()==""){n.siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)});return false}var o='<li class="_sf_box" style="display: none;"><div class="head" onclick="jQuery(this)._sf_custom_field_open(event);"><div class="left"></div><div class="right close" onclick="jQuery(this)._sf_custom_field_remove(event);"><i class="icon-cancel"></i></div><div class="clear"></div></div><div class="inside"><div class="one-half"><p style="position: relative;"><label>'+r+'</label><input type="text" class="_sf_custom_field_label small-input" onblur="jQuery(this)._sf_custom_field_update();" /><small class="error tooltip right" style="top: 19px;">!</small></p></div><div class="one-half last"><p style="position: relative;"><label>'+i+'</label> <input type="text" class="_sf_custom_field_value small-input" onblur="jQuery(this)._sf_custom_field_update();" /><small class="error tooltip left" style="top: 19px;">!</small></p></div><div class="clear"></div></div></li>';s.append(o);var u=s.find("li:last");u.find(".head .left").text(t.val());u.find("input._sf_custom_field_label").val(t.val());u.find("input._sf_custom_field_value").val(n.val());u.fadeIn(200);t.val("").focus();n.val("");s._sf_custom_field_refresh();s._sf_custom_field_refresh_sortable()},_sf_custom_field_add_all:function(){jQuery("#_sf_custom_field_label, #_sf_custom_field_value").keydown(function(e){if(e.which==13){jQuery("#_sf_custom_field_add")._sf_add_custom_field();e.preventDefault();return false}})},_sf_custom_field_refresh_sortable:function(){var e=this;e.sortable({items:"> li",handle:".head",helper:"clone",revert:100,stop:function(t,n){e._sf_custom_field_refresh()}})},_sf_custom_field_refresh:function(){var e=this;var t=jQuery("#_sf_custom_fields_input");console.log("a");var n={};e.children("li").each(function(e,t){var r={};r["label"]=jQuery(this).find("._sf_custom_field_label").val();r["value"]=jQuery(this).find("._sf_custom_field_value").val();n[e]=r});var r=JSON.stringify(n);t.val(r)},_sf_delete_submission:function(e){var t=this.parent().parent();jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_delete_submission",nonce:sf_us._sf_delete_submission_nonce,post_id:e},success:function(e){if(!e.error){t.slideUp(200,function(){jQuery(this).remove()});jQuery("#message").removeClass("error").addClass("success").find("span").text(e.message);jQuery("#message i").attr("class","icon-ok-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(3e3).slideUp(200)})}else{jQuery("#message").removeClass("success").addClass("error").find("span").text(e.message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(3e3).slideUp(200)})}}})},_sf_spot_submit:function(){var e=this;e.submit(function(t){tinyMCE.triggerSave();tinyMCE.triggerSave();e.spin({lines:11,length:16,width:5,radius:14,corners:1,speed:1.9,color:"#000",top:"100"}).children("*:not(div.spinner)").css({opacity:.3});e.find("small.error").hide();e.find("*.error:not(small)").removeClass("error");var n=false;var r=new Array;var i=e.find("#_sf_spot_title");if(i.val()==""){n=true;r.push("#_sf_spot_title")}if(jQuery("#_sf_categories_box").length>0){var s=false;e.find('input[name="_sf_category[]"]').each(function(){if(jQuery(this).is(":checked")){s=true}});if(s===false){n=true;r.push("#_sf_categories_box")}}var o=e.find("#_sf_address");if(o.val()==""){n=true;r.push("#_sf_address")}var u=e.find("#_sf_latitude");if(u.val()==""||u.val()<-90||u.val()>90||isNaN(u.val())){n=true;r.push("#_sf_latitude")}var a=e.find("#_sf_longitude");if(a.val()==""||a.val()<-180||a.val()>180||isNaN(a.val())){n=true;r.push("#_sf_longitude")}jQuery(".required-dropdown").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).find("option:selected").length==0){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).parent().parent().slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});jQuery(".required-dependent").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){var e=jQuery(this).find("select");if(e.find("option:selected").length==0&&e.find("option").length>0){n=true;var t=e.attr("id");r.push("#"+t);e.parent().parent().slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});jQuery(".required-num").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).val()==""||isNaN(jQuery(this).val())){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).parent().parent().slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});jQuery(".required").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).val()==""){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).closest(".error").slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});jQuery(".required-file").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).children("li:not(._sf_box_clone)").length==0){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).siblings(".error").slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});if(n===true){e.spin(false).children("*").css({opacity:1});jQuery("#message").removeClass("success").addClass("error").find("span").text(sf_us.submit_error_message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(3e3).slideUp(200)});jQuery("html, body").animate({scrollTop:0},500);jQuery.each(r,function(e,t){jQuery(t).siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)});jQuery(t).addClass("error")})}else{var f=jQuery("#_sf_spot_id").val();jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_submit",nonce:sf_us._sf_submit_nonce,data:e.serialize(),post_id:f},success:function(t){console.log(t);if(!t.error){if(window.location.href.indexOf("action=add-new")!=-1){theHref=window.location.href.replace("action=add-new","message=success")}else{theHref=window.location.href.split("?");theHref=theHref[0]+"?message=success"}window.location.href=theHref}else{e.spin(false).children("*").css({opacity:1});jQuery("#message").removeClass("success").addClass("error").find("span").text(t.message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(4e3).slideUp(200)});jQuery("html, body").animate({scrollTop:0},300)}}})}t.preventDefault();return false})},_sf_refresh_cart:function(e){isCartRefreshing=true;var t=this;t.children("*").hide();t.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});if(typeof _sf_us_refresh_cart!="undefined"){_sf_us_refresh_cart.abort()}_sf_us_refresh_cart=jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_refresh_cart",nonce:sf_us._sf_refresh_cart_nonce,post_id:e},success:function(n){console.log(n);if(n.cart_items.length>0){t.children("*").show();t.show().spin(false);var r="";jQuery.each(n.cart_items,function(t,n){r+='<li class="cart-item';if(n.trash===false){r+=" not-trash"}r+='">';r+='<span class="cart-trash" onclick="jQuery(this)._sf_remove_from_cart('+e+", '"+n.cartid+'\');"><i class="icon-trash"></i></span>';r+="<h4>"+n.title+"</h4><h5>"+n.description+"</h5>";r+='<span class="price">'+n.price+"</span>";r+="</li>"});t.find("ul.cart-items").html(r);t.find(".total span").html(n.cart_total);t.find(".cart-totals").show();t.find('input[type="checkbox"]').each(function(){jQuery(this).replaceCheckbox()})}else{t.fadeOut(200)}isCartRefreshing=false}})},_sf_us_add_to_cart:function(e,t){var n=jQuery("#submit-cart");var r=this;r.hide();r.parent().spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,color:"#333"});n.children("*").hide();n.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_add_to_cart",nonce:sf_us._sf_add_to_cart_nonce,post_id:t,field_action:e},success:function(e){r.parent().spin(false);jQuery("body, html").stop().animate({scrollTop:0},300);n.show()._sf_refresh_cart(t);r.parent().find("em").css({display:"inline"})}})},_sf_us_add_to_cart_2:function(e,t){var n=jQuery("#submit-cart");var r=this;r.find("span").hide();r.spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,color:"#333"});n.children("*").hide();n.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_add_to_cart",nonce:sf_us._sf_add_to_cart_nonce,post_id:t,field_action:e},success:function(e){r.spin(false);jQuery("body, html").stop().animate({scrollTop:0},300);n.show()._sf_refresh_cart(t);r.find("em").fadeIn(200)}})},_sf_remove_from_cart:function(e,t){var n=this;var r=jQuery("#submit-cart");n.hide();r.children("*").hide();r.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_remove_from_cart",nonce:sf_us._sf_remove_from_cart_nonce,post_id:e,field_action:t},success:function(i){n.spin(false);r.show()._sf_refresh_cart(e);jQuery("#"+t).show();jQuery("#"+t).find("*").show();jQuery("#"+t+" em").hide()}})},_sf_checkout_cart:function(e,t){var n=this;var r=jQuery("#_sf_spot");n.spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,left:-33,color:"#333"});if(typeof checkoutUrl!="undefined"){checkoutUrl.abort()}var i="false";if(jQuery("#_sf_submission_recurring").length>0){if(jQuery("#_sf_submission_recurring").is(":checked")){i="true"}}var s="false";if(jQuery("#_sf_featured_recurring").length>0){if(jQuery("#_sf_featured_recurring").is(":checked")){s="true"}}checkoutUrl=jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_checkout",nonce:sf_us.checkout_nonce,post_id:t,current_url:window.location.href,recurring_featured:s,recurring_submission:i},success:function(e){n.spin(false);if(e.error===true){jQuery("#message").removeClass("success").addClass("error").find("span").text(e.error_message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(3e3).slideUp(200)})}else{jQuery("#_sf_spot")._sf_save_spot(t,"false",function(){jQuery("#message").removeClass("error").addClass("success").find("span").text(e.message);jQuery("#message i").attr("class","icon-ok-circle");jQuery("#message").slideDown(200,function(){window.location.href=e.redirect})})}}});e.preventDefault();return false},_sf_open_user_notification:function(){var e=this;e.click(function(e){var t=jQuery(document).height();jQuery("body").append('<div id="notify-me-signup" style="height: '+t+'px;"><div><div class="inside"></div></div></div>');jQuery("body, html").animate({scrollTop:0},400);var n=jQuery("#notify-me-signup").fadeIn(300);var r=n.children("div").children("div");n.click(function(e){if(e.target.id=="notify-me-signup"){n._sf_close_user_notification()}});r.spin({lines:9,length:5,width:3,radius:6,corners:1,color:"#000",speed:1.8});formCont=jQuery("#search-spots");oepnNotificationAjax=jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"HTML",data:{action:"_sf_load_notification_signup",nonce:sf_us._sf_load_notification_signup_nonce,data:formCont.serialize()},success:function(e){r.spin(false).stop().parent().animate({width:"300px"},200,function(){r.html(e);r.children("*:not(.thankyou)").fadeIn(200);r.parent().css({height:"auto"});r.find("h2 i").click(function(){n._sf_close_user_notification()})})}});e.preventDefault();return false})},_sf_close_user_notification:function(){var e=this;if(typeof oepnNotificationAjax!="undefined"){oepnNotificationAjax.abort()}e.fadeOut(300,function(){jQuery(this).remove()})},_sf_send_user_notification:function(){var e=this;var t=e.find('input[type="submit"]');e.submit(function(n){e.children("*").stop().animate({opacity:.1});t.attr("disabled","disabled");e.spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});e.find("small.error, p.error small").remove();e.find("p.error").removeClass("error");sendNotificationAjax=jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_send_notification_signup",nonce:sf_us._sf_send_notification_signup_nonce,data:e.serialize()},success:function(n){console.log(n);if(n.error){e.children("*").stop().animate({opacity:1});t.removeAttr("disabled");e.spin(false);if(n.error="field"){jQuery.each(n.message,function(t,n){e.find('input[name="'+n.field+'"]').parent().addClass("error").append("<small>"+n.message+"</small>")})}else{e.prepend('<p><small class="error" style="display: block;">'+n.message+"</small></p>");e.children("small").fadeIn(300)}}else{e.slideUp(200);e.siblings(".thankyou").slideDown(200)}}});n.preventDefault();return false})},generatePlot:function(e){var t=this;jQuery.plot(t,e,{series:{stack:0,lines:{show:true,lineWidth:0,fill:true},points:{show:true}},xaxis:{mode:"time",timeformat:"%d/%m",ticks:8,tickLength:10,tickColor:"#d0d0d0"},yaxis:{show:false,autoscaleMargin:.1},grid:{hoverable:true,clickable:true,borderWidth:{left:1,right:1,top:0,bottom:1},borderColor:"#d0d0d0",margin:{top:20}},legend:{show:true,labelFormatter:function(e,t){var n=false;jQuery("#page-view-labels ul li").each(function(){if(jQuery(this).attr("title")==e){n=true}});if(n==false){markup='<li title="'+e+'"><span>';markup+='<input type="hidden" name="color" value="'+t.color+'" />';markup+='<div style="width:4px;height:0;border:8px solid '+t.color+';overflow:hidden; float: left; margin-right: 7px; margin-top: 3px;"></div>';markup+="<span>"+e+"</span>";markup+="</span></li>";jQuery("#page-view-labels ul").append(markup)}return false}}})},_sf_tooltips:function(e,t,n,r,i){var s=this;_sf_current_step=0;_sf_tooltips_steps=e;_sf_tooltips_next=t;_sf_tooltips_dismiss=n;_sf_tooltips_prev=r;_sf_tooltips_cookie=i;if(jQuery("#_sf_tooltip_wrapper").length==0){jQuery("body").append('<div id="_sf_tooltip_wrapper"></div>')}jQuery("#_sf_tooltip_wrapper").click(function(e){if(e.target.id=="_sf_tooltip_wrapper"){jQuery("#_sf_tooltip_wrapper")._sf_tooltips_next()}});if(typeof isCartRefreshing!="undefined"){_sf_tooltip_interval=setInterval(function(){if(isCartRefreshing===false){s._sf_tooltips_call(e)}},200)}else{s._sf_tooltips_call(e)}},_sf_tooltips_call:function(e){if(typeof _sf_tooltip_interval!="undefined"){clearInterval(_sf_tooltip_interval)}var t=jQuery.cookie(_sf_tooltips_cookie);if(t=="false"){return false}var n=this;var r=jQuery("#"+e[_sf_current_step].container);var i=jQuery("#_sf_tooltip_wrapper");var s=jQuery(document).height();var o=jQuery(document).width();i.height(s);i.width(o);var u='<div class="_sf_tooltip_wrapper"><div class="inside"><i class="icon-sort-up"></i><div class="left">'+(parseInt(_sf_current_step)+1)+"</div>";u+='<div class="right">';u+='<div class="content"><h4>'+e[_sf_current_step].title+"</h4><p>"+e[_sf_current_step].description+"</p></div>";u+='<span class="dismiss" onclick="jQuery(\'#_sf_tooltip_wrapper\')._sf_tooltips_dismiss();"><i class="icon-block"></i>'+_sf_tooltips_dismiss+"</span>";if(_sf_current_step+1<e.length){u+='<span class="next" onclick="jQuery(\'#_sf_tooltip_wrapper\')._sf_tooltips_next();">'+_sf_tooltips_next+'<i class="icon-right-circled"></i></span>'}if(_sf_current_step>0){u+='<span class="prev" onclick="jQuery(\'#_sf_tooltip_wrapper\')._sf_tooltips_prev();"><i class="icon-left-circled"></i>'+_sf_tooltips_prev+"</span>"}u+="</div>";u+='<div class="clear"></div></div>';u+="</div>";i.html("").append(u);if(e[_sf_current_step].container=="content"){var a=jQuery("#content .wrapper").width()*.9;fieldOffset=jQuery("#content .wrapper").offset();fieldTop=fieldOffset.top+100;i.children("div").css({left:fieldOffset.left+jQuery("#content .wrapper").width()*.05,top:fieldTop});i.children("div").width(a);i.find(".icon-sort-up").remove()}else{var f=r.outerWidth();if(f<300){f=300}i.children("div").width(f);fieldOffset=r.offset();fieldTop=fieldOffset.top+r.outerHeight()+15;r.css({"z-index":5e3,position:"relative"});i.children("div").css({left:fieldOffset.left,top:fieldTop})}if(e[_sf_current_step].align=="right"){i.children("div").css({left:"auto"});i.css({display:"block",opacity:1});i.children("div").css({display:"block",opacity:0});var l=i.children("div").width();var c=jQuery(window).width()-(fieldOffset.left+r.width())-15;i.children("div").addClass("right-align").css({right:c+"px",opacity:1,display:"none"})}else{i.children("div").removeClass("right-align").css({right:"auto"})}i.fadeIn(150);i.children("div").fadeIn(150);var h=50;if(jQuery("#header-space").length>0){var h=50+jQuery("#header-space").height()}jQuery(window).bind("mousewheel",function(){jQuery("html, body").stop(true)});jQuery("body, html").animate({scrollTop:fieldOffset.top-h},150,function(){})},_sf_tooltips_next:function(){if(_sf_current_step+1==_sf_tooltips_steps.length){jQuery("#_sf_tooltip_wrapper")._sf_tooltips_dismiss()}var e=jQuery("#"+_sf_tooltips_steps[_sf_current_step].container);var t=this;t.children("div").fadeOut(200);_sf_current_step++;e.css({"z-index":"auto"});jQuery("body")._sf_tooltips_call(_sf_tooltips_steps)},_sf_tooltips_prev:function(){var e=jQuery("#"+_sf_tooltips_steps[_sf_current_step].container);var t=this;t.children("div").fadeOut(200);_sf_current_step--;e.css({"z-index":"auto"});jQuery("body")._sf_tooltips_call(_sf_tooltips_steps)},_sf_tooltips_dismiss:function(){var e=jQuery("#"+_sf_tooltips_steps[_sf_current_step].container);var t=this;t.fadeOut(300);e.css({"z-index":"auto"});jQuery.cookie(_sf_tooltips_cookie,"false",{path:"/"})},_sf_fb_sign_up:function(){var e=this;isFacebookLoading=false;e.click(function(){FB.login(function(t){if(t.status==="connected"){e._sf_fb_log_in(t)}},{scope:"email"})})},_sf_fb_log_in:function(e){if(isFacebookLoading===false){isFacebookLoading=true;FB.api("/me",function(e){isFacebookLoading=false;jQuery("#_sf_login_row").children("*").stop().animate({opacity:.3});jQuery('#_sf_login_row input[type="submit"]').attr("disabled","disabled");jQuery("#_sf_login_row").spin({lines:9,length:7,width:4,radius:8,corners:1,speed:1.9});jQuery("#_sf_login_row").find("small.error, p.error small").remove();jQuery("#_sf_login_row").find("p.error").removeClass("error");jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_us_fb_login",nonce:sf_us._sf_us_fb_login_nonce,firstname:e.first_name,lastname:e.last_name,user_id:e.id,email:e.email},success:function(e){if(e.error){alert(e.message)}else{window.location.href=window.location.href}}});console.log(e)})}},_sf_field_categories:function(){var e=this;_sf_field_categories_array=[];e.find("input").each(function(){var e=jQuery(this);if(e.is(":checked")){var t=e.val();_sf_field_categories_array.push(t)}else{var t=e.val();jQuery.each(_sf_field_categories_array,function(e,n){if(n===t){_sf_field_categories_array.splice(e,1)}})}});jQuery("#_sf_custom_search_fields_wrapper")._sf_field_categories_sort();e.find(".checkbox-replace, .radio-replace").each(function(){jQuery(this).click(function(e){var t=jQuery(this).find("input");if(t.attr("type")=="radio"){_sf_field_categories_array=new Array}if(t.is(":checked")){var n=t.val();_sf_field_categories_array.push(n)}else{var n=t.val();jQuery.each(_sf_field_categories_array,function(e,t){if(t===n){_sf_field_categories_array.splice(e,1)}})}console.log(_sf_field_categories_array);jQuery("#_sf_custom_search_fields_wrapper")._sf_field_categories_sort()})})},_sf_field_categories_sort:function(){var e=this;jQuery("body").find("._sf_box").each(function(){var e=jQuery(this).attr("class").split(" ");var t=jQuery(this);console.log(e);var n=e[3];if(typeof n=="undefined"){n="all"}if(n.indexOf("all")==-1){var r=n.split("_");var i=false;jQuery.each(r,function(e,t){if(jQuery.inArray(t,_sf_field_categories_array)!=-1){i=true}});if(i===true){t.show()}else{t.hide()}}else{jQuery(this).show()}})},_sf_show_user_info:function(){var e=this;var t=e.find(".init");var n=e.find(".full");t.hide();n.show()},_sf_field_categories_load_subcats:function(){var e=this;var t=e.parent().parent().find("> .checkbox-replace, > .checkbox-label");t.each(function(){jQuery(this).on("click",function(){if(jQuery(this).parent().find("> .checkbox-replace > input:first").is(":checked")){var e=jQuery(this).parent().find("> .checkbox-replace > input:first").val();jQuery(this)._sf_load_subcategories_submission(e)}else{jQuery(this).siblings("ul").fadeOut(250,function(){jQuery(this).remove()})}})})},_sf_load_subcategories_submission:function(e){var t=this;t.parent().css({"padding-bottom":"30px"}).spin({lines:7,length:0,width:4,radius:4,corners:1,speed:1.9,top:28});jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_load_subcategories_submission",nonce:sf_us._sf_load_subcategories_submission_nonce,parent:e},success:function(e){if(e.error){t.parent().spin(false)}else{t.parent().append("<ul></ul>");var n=t.parent().children("ul");jQuery.each(e.terms,function(e,r){var i="";if(r.has_children){i=' class="load-subcategories"'}n.append('<li style="display: none;"><input type="checkbox" name="_sf_category[]" id="_sf_category_'+r.ID+'" value="'+r.ID+'"'+i+' /><span class="checkbox-label">'+r.name+"</span></li>");t.parent().spin(false).css({"padding-bottom":0});n.children("li").children('input[type="checkbox"]').each(function(){var e=jQuery(this).parent();jQuery(this).replaceCheckbox();e.children(".checkbox-label").click(function(){if(jQuery(this).siblings("div.checkbox-replace").children("input").is(":checked")){jQuery(this).siblings("div.checkbox-replace").removeClass("checkbox-replace-checked").children("input").removeAttr("checked")}else{jQuery(this).siblings("div.checkbox-replace").addClass("checkbox-replace-checked").children("input").attr("checked","checked")}})})});n.children("li").children(".load-subcategories").children("input")._sf_field_categories_load_subcats();n.find("li").fadeIn(300)}}})},_sf_spot_submit_translation:function(){var e=this;e.submit(function(t){tinyMCE.triggerSave();tinyMCE.triggerSave();e.spin({lines:11,length:16,width:5,radius:14,corners:1,speed:1.9,color:"#000",top:"100"}).children("*:not(div.spinner)").css({opacity:.3});e.find("small.error").hide();e.find("*.error:not(small)").removeClass("error");var n=false;var r=new Array;var i=e.find("#_sf_spot_title");if(i.val()==""){n=true;r.push("#_sf_spot_title")}var s=e.find("#_sf_address");if(s.val()==""){n=true;r.push("#_sf_address")}jQuery(".required").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).val()==""){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).closest(".error").slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});jQuery(".required-file").each(function(){if(jQuery(this).closest("._sf_box").is(":visible")){if(jQuery(this).children("li:not(._sf_box_clone)").length==0){n=true;var e=jQuery(this).attr("id");r.push("#"+e);jQuery(this).siblings(".error").slideDown(200,function(){jQuery(this).css({overflow:"visible"})})}}});if(n===true){e.spin(false).children("*").css({opacity:1});jQuery("#message").removeClass("success").addClass("error").find("span").text(sf_us.submit_error_message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(3e3).slideUp(200)});jQuery("html, body").animate({scrollTop:0},500);jQuery.each(r,function(e,t){jQuery(t).siblings("small").fadeIn(200,function(){jQuery(this).delay(3e3).fadeOut(200)});jQuery(t).addClass("error")})}else{var o=jQuery("#_sf_spot_id").val();jQuery.ajax({url:sf_us.ajaxurl,type:"post",dataType:"json",data:{action:"_sf_submit_translation",nonce:sf_us._sf_submit_translation_nonce,data:e.serialize(),post_id:o},success:function(t){console.log(t);if(!t.error){if(window.location.href.indexOf("action=add-new")!=-1){theHref=window.location.href.replace("action=add-new","message=success")}else{theHref=window.location.href.split("?");theHref=theHref[0]+"?message=success"}window.location.href=theHref}else{e.spin(false).children("*").css({opacity:1});jQuery("#message").removeClass("success").addClass("error").find("span").text(t.message);jQuery("#message i").attr("class","icon-cancel-circle");jQuery("#message").slideDown(200,function(){jQuery(this).delay(4e3).slideUp(200)});jQuery("html, body").animate({scrollTop:0},300)}}})}t.preventDefault();return false})}})})(jQuery);jQuery.scrollTo=jQuery.fn.scrollTo=function(e,t,n,r){if(!(this instanceof jQuery))return jQuery.fn.scrollTo.apply(jQuery("html, body"),arguments);n=jQuery.extend({},{gap:{x:0,y:0},animation:{easing:"swing",duration:600,complete:jQuery.noop,step:jQuery.noop}},n);return this.each(function(){var e=jQuery(this);e.stop().animate({scrollTop:!isNaN(Number(t))?t:jQuery(t).offset().top+n.gap.y},n.animation)})}